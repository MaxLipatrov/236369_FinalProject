{"ast":null,"code":"var _jsxFileName = \"/home/max/PycharmProjects/236369/Final_Project/ReactApp/src/Component/About.js\";\nimport React, { Component } from 'react';\nimport jwt_decode from 'jwt-decode';\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport Alert from \"reactstrap/es/Alert\";\nimport DatePicker from \"react-datepicker\";\nimport Button from \"reactstrap/es/Button\";\n\nconst update = updatedUser => {\n  axios.defaults.withCredentials = true;\n  return axios.put('http://127.0.0.1:5000/users/' + updatedUser.id, {\n    username: updatedUser.username,\n    first_name: updatedUser.first_name,\n    last_name: updatedUser.last_name,\n    gender: updatedUser.gender,\n    birth_date: updatedUser.birth_date,\n    email: updatedUser.email\n  }).then(response => {\n    return response.data;\n  });\n};\n\nconst isChecked = gender => {\n  let res = false;\n\n  switch (gender.field) {\n    case 'Male':\n      res = gender.value == 'male' || gender.value == 'Male';\n      break;\n\n    case 'Female':\n      res = gender.value == 'female' || gender.value == 'Female';\n      break;\n\n    case 'Other':\n      res = gender.value == 'other' || gender.value == 'Other';\n      break;\n  }\n\n  return res;\n};\n\nconst validEmailRegex = RegExp(/^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i);\n\nconst validateForm = errors => {\n  let valid = true;\n  Object.values(errors).forEach(val => val.length > 0 && (valid = false));\n  return valid;\n};\n\nfunction ProfileInfo(props) {\n  return React.createElement(\"table\", {\n    className: \"table col-md-6 mx-auto\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }, \"Username\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, props.username)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, \"First Name\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, props.first_name)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"Last Name\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, props.last_name)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, \"Gender\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, props.gender)), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, \"Birth Date\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, moment(props.birth_date).format(\"LL\"))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"Email\")), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, props.email))));\n}\n\nfunction EditProfile(props) {\n  return React.createElement(\"div\", {\n    className: \"col-md-6 mt-3 mx-auto\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    noValidate: true,\n    onSubmit: props.onSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    className: \"h3 mb-3 font-weight-normal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, \"Update Profile\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, props.invalid > 0 && React.createElement(Alert, {\n    color: \"danger\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, \"Your update attempt is invalid. Please try again!\"), React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"Username\"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"username\",\n    placeholder: \"Enter your username\",\n    value: props.username,\n    onChange: props.onChange,\n    noValidate: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }), props.errors.username.length > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, props.errors.username), props.user_taken > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, \"This username is taken\")), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, \"First name\"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"first_name\",\n    placeholder: \"Enter your first name\",\n    value: props.first_name,\n    onChange: props.onChange,\n    noValidate: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }), props.errors.first_name.length > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, props.errors.first_name)), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, \"Last name\"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    name: \"last_name\",\n    placeholder: \"Enter your last name\",\n    value: props.last_name,\n    onChange: props.onChange,\n    noValidate: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), props.errors.last_name.length > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, props.last_name)), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"Gender\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"radio\",\n    name: \"gender\",\n    value: \"Male\",\n    onChange: props.onChange,\n    checked: isChecked({\n      field: 'Male',\n      value: props.gender\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }), \" Male\", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"radio\",\n    name: \"gender\",\n    value: \"Female\",\n    onChange: props.onChange,\n    checked: isChecked({\n      field: 'Female',\n      value: props.gender\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }), \" Female\", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"radio\",\n    name: \"gender\",\n    value: \"other\",\n    onChange: props.onChange,\n    checked: isChecked({\n      field: 'Other',\n      value: props.gender\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }), \" Other\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, \"Birth date\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }), React.createElement(DatePicker, {\n    name: \"birth_date\",\n    selected: new Date(props.birth_date),\n    onChange: props.handlechange,\n    dateFormat: \"dd/MM/yyyy\",\n    maxDate: new Date(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, \"Email address\"), React.createElement(\"input\", {\n    type: \"email\",\n    className: \"form-control\",\n    name: \"email\",\n    placeholder: \"Enter email\",\n    value: props.email,\n    onChange: props.onChange,\n    noValidate: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }), props.errors.email.length > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, props.errors.email), props.email_taken > 0 && React.createElement(\"span\", {\n    className: \"error\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"This email is taken\")), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"image_file\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Profile Picture\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"file\",\n    onChange: props.onchangeimg,\n    placeholder: \"Update your profile picture\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  })), React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-lg btn-primary btn-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"Update\")));\n}\n\nexport class About extends Component {\n  constructor() {\n    super();\n\n    this.handleChange = date => {\n      this.setState({\n        birth_date: date\n      });\n    };\n\n    this.state = {\n      current_user: 0,\n      username: '',\n      first_name: '',\n      last_name: '',\n      gender: '',\n      birth_date: '',\n      email: '',\n      errors: {\n        username: '',\n        email: '',\n        first_name: '',\n        last_name: ''\n      },\n      user_taken: 0,\n      email_taken: 0,\n      invalid: 0,\n      flag: true,\n      file: null,\n      path_img: ''\n    };\n    this.onChange = this.onChange.bind(this);\n    this.onChangeImg = this.onChangeImg.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  componentWillReceiveProps() {\n    this.componentDidMount();\n  }\n\n  componentDidMount() {\n    const token = localStorage.usertoken;\n\n    if (token) {\n      const decoded = jwt_decode(token);\n      this.setState({\n        current_user: decoded.identity.id\n      });\n    }\n\n    axios.get('http://127.0.0.1:5000/users/' + this.props.id).then(response => {\n      this.setState({\n        username: response.data.username,\n        first_name: response.data.first_name,\n        last_name: response.data.last_name,\n        gender: response.data.gender,\n        birth_date: response.data.birth_date,\n        email: response.data.email\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  toggleUpdate() {\n    this.setState({\n      flag: !this.state.flag,\n      errors: {\n        username: '',\n        email: '',\n        first_name: '',\n        last_name: ''\n      },\n      user_taken: 0,\n      email_taken: 0,\n      invalid: 0,\n      file: null\n    });\n    if (!this.state.flag) this.componentDidMount();\n  }\n\n  onChange(e) {\n    //  e.preventDefault()\n    let errors = this.state.errors;\n    const _e$target = e.target,\n          name = _e$target.name,\n          value = _e$target.value;\n\n    switch (name) {\n      case 'username':\n        this.setState({\n          user_taken: 0\n        });\n        errors.username = value.length < 1 || value.length > 20 ? 'Username is not valid!' : '';\n        break;\n\n      case 'email':\n        this.setState({\n          email_taken: 0\n        });\n        errors.email = validEmailRegex.test(value) && value.length <= 120 ? '' : 'Email is not valid!';\n        break;\n\n      case 'first_name':\n        errors.first_name = value.length > 20 ? 'First name is too long' : '';\n        break;\n\n      case 'last_name':\n        errors.last_name = value.length > 20 ? 'Last name is too long' : '';\n        break;\n\n      default:\n        break;\n    }\n\n    this.setState({\n      errors,\n      [name]: value\n    });\n  }\n\n  onChangeImg(e) {\n    this.setState({\n      file: e.target.files[0]\n    });\n  }\n\n  uploadImg() {\n    let img = this.state.file;\n    const formData = new FormData();\n    formData.append(\"file\", img);\n    axios.defaults.withCredentials = true;\n    axios.put(\"http://127.0.0.1:5000/image/\" + this.props.id, formData).then(res => {\n      console.log(res.data.image_file);\n      this.props.updatePic({\n        image_file: res.data.image_file\n      });\n    }).catch(err => {\n      console.warn(err);\n      this.setState({\n        path_img: ''\n      });\n    });\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    this.setState({\n      invalid: 0\n    });\n    this.setState({\n      user_taken: 0\n    });\n    this.setState({\n      email_taken: 0\n    });\n    const updatedUser = {\n      id: this.props.id,\n      username: this.state.username,\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      gender: this.state.gender,\n      birth_date: this.state.birth_date,\n      email: this.state.email\n    };\n    const info = {\n      email: this.state.email,\n      username: this.state.username\n    };\n\n    if (validateForm(this.state.errors)) {\n      update(updatedUser).then(res => {\n        if (res == 'Updated') {\n          if (this.state.file) {\n            this.uploadImg();\n            this.props.updateInfo(info);\n          } else {\n            console.log(\"here5\");\n            this.props.updateInfo(info);\n          }\n\n          this.setState({\n            flag: true,\n            file: null\n          });\n        }\n\n        if (res == 'Username Taken') {\n          this.setState({\n            user_taken: 1\n          });\n          this.setState({\n            invalid: 1\n          });\n        }\n\n        if (res == 'Email Taken') {\n          this.setState({\n            email_taken: 1\n          });\n          this.setState({\n            invalid: 1\n          });\n        }\n      });\n    } else {\n      this.setState({\n        invalid: 1\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"jumbotron mt-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375\n      },\n      __self: this\n    }, this.state.flag && React.createElement(ProfileInfo, {\n      username: this.state.username,\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      gender: this.state.gender,\n      birth_date: this.state.birth_date,\n      email: this.state.email,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"m-md-4\",\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }, this.state.flag && this.state.current_user == this.props.id && React.createElement(Button, {\n      className: \"my-3\",\n      color: \"secondary\",\n      onClick: this.toggleUpdate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385\n      },\n      __self: this\n    }, \"Edit Profile\")), !this.state.flag && React.createElement(EditProfile, {\n      username: this.state.username,\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      gender: this.state.gender,\n      birth_date: this.state.birth_date,\n      email: this.state.email,\n      errors: this.state.errors,\n      onChange: this.onChange,\n      handlechange: this.handleChange,\n      onSubmit: this.onSubmit,\n      invalid: this.state.invalid,\n      user_taken: this.state.user_taken,\n      email_taken: this.state.email_taken,\n      flag: this.state.flag,\n      toggleUpdate: this.toggleUpdate,\n      onchangeimg: this.onChangeImg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"col-md-6 mt-1 mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405\n      },\n      __self: this\n    }, !this.state.flag && React.createElement(Button, {\n      className: \"btn btn-lg btn-block\",\n      color: \"secondary\",\n      onClick: this.toggleUpdate.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406\n      },\n      __self: this\n    }, \"Cancel\"))));\n  }\n\n}\nexport default About;","map":{"version":3,"sources":["/home/max/PycharmProjects/236369/Final_Project/ReactApp/src/Component/About.js"],"names":["React","Component","jwt_decode","moment","axios","Alert","DatePicker","Button","update","updatedUser","defaults","withCredentials","put","id","username","first_name","last_name","gender","birth_date","email","then","response","data","isChecked","res","field","value","validEmailRegex","RegExp","validateForm","errors","valid","Object","values","forEach","val","length","ProfileInfo","props","format","EditProfile","onSubmit","invalid","onChange","user_taken","Date","handlechange","email_taken","onchangeimg","About","constructor","handleChange","date","setState","state","current_user","flag","file","path_img","bind","onChangeImg","componentWillReceiveProps","componentDidMount","token","localStorage","usertoken","decoded","identity","get","catch","err","console","log","toggleUpdate","e","target","name","test","files","uploadImg","img","formData","FormData","append","image_file","updatePic","warn","preventDefault","info","updateInfo","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;AAEA,MAAMC,MAAM,GAAGC,WAAW,IAAI;AAC1BL,EAAAA,KAAK,CAACM,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AACF,SAAOP,KAAK,CACTQ,GADI,CACA,iCAA+BH,WAAW,CAACI,EAD3C,EAC+C;AAClDC,IAAAA,QAAQ,EAAEL,WAAW,CAACK,QAD4B;AAElDC,IAAAA,UAAU,EAAEN,WAAW,CAACM,UAF0B;AAGlDC,IAAAA,SAAS,EAAEP,WAAW,CAACO,SAH2B;AAIlDC,IAAAA,MAAM,EAAER,WAAW,CAACQ,MAJ8B;AAKlDC,IAAAA,UAAU,EAAET,WAAW,CAACS,UAL0B;AAMlDC,IAAAA,KAAK,EAAEV,WAAW,CAACU;AAN+B,GAD/C,EASJC,IATI,CASCC,QAAQ,IAAI;AACd,WAAOA,QAAQ,CAACC,IAAhB;AACH,GAXI,CAAP;AAYD,CAdD;;AAgBA,MAAMC,SAAS,GAAGN,MAAM,IACxB;AACE,MAAIO,GAAG,GAAC,KAAR;;AACA,UAAOP,MAAM,CAACQ,KAAd;AACE,SAAK,MAAL;AAAaD,MAAAA,GAAG,GAAGP,MAAM,CAACS,KAAP,IAAc,MAAd,IAAwBT,MAAM,CAACS,KAAP,IAAc,MAA5C;AACb;;AACA,SAAK,QAAL;AAAeF,MAAAA,GAAG,GAAGP,MAAM,CAACS,KAAP,IAAc,QAAd,IAA0BT,MAAM,CAACS,KAAP,IAAc,QAA9C;AACf;;AACA,SAAK,OAAL;AAAcF,MAAAA,GAAG,GAAGP,MAAM,CAACS,KAAP,IAAc,OAAd,IAAyBT,MAAM,CAACS,KAAP,IAAc,OAA7C;AACd;AANF;;AAQA,SAAOF,GAAP;AACD,CAZD;;AAaA,MAAMG,eAAe,GACnBC,MAAM,CAAC,wHAAD,CADR;;AAGA,MAAMC,YAAY,GAAIC,MAAD,IAAY;AAC/B,MAAIC,KAAK,GAAG,IAAZ;AACAC,EAAAA,MAAM,CAACC,MAAP,CAAcH,MAAd,EAAsBI,OAAtB,CACGC,GAAD,IAASA,GAAG,CAACC,MAAJ,GAAa,CAAb,KAAmBL,KAAK,GAAG,KAA3B,CADX;AAGA,SAAOA,KAAP;AACD,CAND;;AAQA,SAASM,WAAT,CAAqBC,KAArB,EAA2B;AACzB,SACG;AAAO,IAAA,SAAS,EAAC,wBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAJ,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKA,KAAK,CAACxB,QAAX,CAFF,CADF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAJ,CADJ,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKwB,KAAK,CAACvB,UAAX,CAFF,CALF,EASE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ,CADJ,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKuB,KAAK,CAACtB,SAAX,CAFF,CATF,EAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAJ,CADJ,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKsB,KAAK,CAACrB,MAAX,CAFF,CAbF,EAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAJ,CADJ,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKd,MAAM,CAACmC,KAAK,CAACpB,UAAP,CAAN,CAAyBqB,MAAzB,CAAgC,IAAhC,CAAL,CAFF,CAjBF,EAqBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAJ,CADJ,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAKD,KAAK,CAACnB,KAAX,CAFF,CArBF,CADP,CADH;AA8BD;;AAED,SAASqB,WAAT,CAAqBF,KAArB,EAA2B;AACzB,SACQ;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACL;AAAM,IAAA,UAAU,MAAhB;AAAiB,IAAA,QAAQ,EAAEA,KAAK,CAACG,QAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACS;AAAI,IAAA,SAAS,EAAC,4BAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADT,EAES;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKH,KAAK,CAACI,OAAN,GAAe,CAAf,IAAqB,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yDAD1B,EAIE;AAAO,IAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,EAKE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,IAAI,EAAC,UAHP;AAIE,IAAA,WAAW,EAAC,qBAJd;AAKE,IAAA,KAAK,EAAEJ,KAAK,CAACxB,QALf;AAME,IAAA,QAAQ,EAAEwB,KAAK,CAACK,QANlB;AAOE,IAAA,UAAU,MAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,EAcIL,KAAK,CAACR,MAAN,CAAahB,QAAb,CAAsBsB,MAAtB,GAA+B,CAA/B,IACF;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyBE,KAAK,CAACR,MAAN,CAAahB,QAAtC,CAfF,EAgBGwB,KAAK,CAACM,UAAN,GAAmB,CAAnB,IACD;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAjBF,CAFT,EAqBS;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,IAAI,EAAC,YAHP;AAIE,IAAA,WAAW,EAAC,uBAJd;AAKE,IAAA,KAAK,EAAEN,KAAK,CAACvB,UALf;AAME,IAAA,QAAQ,EAAEuB,KAAK,CAACK,QANlB;AAOE,IAAA,UAAU,MAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAWGL,KAAK,CAACR,MAAN,CAAaf,UAAb,CAAwBqB,MAAxB,GAAiC,CAAjC,IACD;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyBE,KAAK,CAACR,MAAN,CAAaf,UAAtC,CAZF,CArBT,EAmCS;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,IAAI,EAAC,WAHP;AAIE,IAAA,WAAW,EAAC,sBAJd;AAKE,IAAA,KAAK,EAAEuB,KAAK,CAACtB,SALf;AAME,IAAA,QAAQ,EAAEsB,KAAK,CAACK,QANlB;AAOE,IAAA,UAAU,MAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAWIL,KAAK,CAACR,MAAN,CAAad,SAAb,CAAuBoB,MAAvB,GAAgC,CAAhC,IACF;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyBE,KAAK,CAACtB,SAA/B,CAZF,CAnCT,EAiDS;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,EACsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADtC,EAEE;AAAO,IAAA,IAAI,EAAC,OAAZ;AAAoB,IAAA,IAAI,EAAC,QAAzB;AAAkC,IAAA,KAAK,EAAC,MAAxC;AAA+C,IAAA,QAAQ,EAAEsB,KAAK,CAACK,QAA/D;AAAyE,IAAA,OAAO,EAAEpB,SAAS,CAAC;AAACE,MAAAA,KAAK,EAAC,MAAP;AAAcC,MAAAA,KAAK,EAACY,KAAK,CAACrB;AAA1B,KAAD,CAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,WAEwI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFxI,EAGE;AAAO,IAAA,IAAI,EAAC,OAAZ;AAAoB,IAAA,IAAI,EAAC,QAAzB;AAAkC,IAAA,KAAK,EAAC,QAAxC;AAAiD,IAAA,QAAQ,EAAEqB,KAAK,CAACK,QAAjE;AAA2E,IAAA,OAAO,EAAEpB,SAAS,CAAC;AAACE,MAAAA,KAAK,EAAC,QAAP;AAAgBC,MAAAA,KAAK,EAACY,KAAK,CAACrB;AAA5B,KAAD,CAA7F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,aAG8I;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAH9I,EAIE;AAAO,IAAA,IAAI,EAAC,OAAZ;AAAoB,IAAA,IAAI,EAAC,QAAzB;AAAkC,IAAA,KAAK,EAAC,OAAxC;AAAgD,IAAA,QAAQ,EAAEqB,KAAK,CAACK,QAAhE;AAA0E,IAAA,OAAO,EAAEpB,SAAS,CAAC;AAACE,MAAAA,KAAK,EAAC,OAAP;AAAeC,MAAAA,KAAK,EAACY,KAAK,CAACrB;AAA3B,KAAD,CAA5F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,WAjDT,EAuDS;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAO,IAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,EAC4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAD5C,EAEE,oBAAC,UAAD;AACC,IAAA,IAAI,EAAC,YADN;AAEC,IAAA,QAAQ,EAAE,IAAI4B,IAAJ,CAASP,KAAK,CAACpB,UAAf,CAFX;AAGC,IAAA,QAAQ,EAAEoB,KAAK,CAACQ,YAHjB;AAIC,IAAA,UAAU,EAAC,YAJZ;AAKC,IAAA,OAAO,EAAE,IAAID,IAAJ,EALV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAvDT,EAiES;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAEE;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,SAAS,EAAC,cAFZ;AAGE,IAAA,IAAI,EAAC,OAHP;AAIE,IAAA,WAAW,EAAC,aAJd;AAKE,IAAA,KAAK,EAAEP,KAAK,CAACnB,KALf;AAME,IAAA,QAAQ,EAAEmB,KAAK,CAACK,QANlB;AAOE,IAAA,UAAU,MAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAWKL,KAAK,CAACR,MAAN,CAAaX,KAAb,CAAmBiB,MAAnB,GAA4B,CAA5B,IACH;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyBE,KAAK,CAACR,MAAN,CAAaX,KAAtC,CAZF,EAaImB,KAAK,CAACS,WAAN,GAAoB,CAApB,IACF;AAAM,IAAA,SAAS,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAdF,CAjET,EAiFW;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAO,IAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI;AACI,IAAA,IAAI,EAAC,MADT;AAEI,IAAA,QAAQ,EAAET,KAAK,CAACU,WAFpB;AAGI,IAAA,WAAW,EAAC,6BAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,CAjFX,EA0FS;AACE,IAAA,IAAI,EAAC,QADP;AAEE,IAAA,SAAS,EAAC,kCAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA1FT,CADK,CADR;AAsGD;;AAED,OAAO,MAAMC,KAAN,SAAoBhD,SAApB,CAA8B;AACnCiD,EAAAA,WAAW,GAAG;AACZ;;AADY,SAqEdC,YArEc,GAqECC,IAAI,IAAI;AACrB,WAAKC,QAAL,CAAc;AACZnC,QAAAA,UAAU,EAAEkC;AADA,OAAd;AAGD,KAzEa;;AAEZ,SAAKE,KAAL,GAAa;AACXC,MAAAA,YAAY,EAAE,CADH;AAEXzC,MAAAA,QAAQ,EAAE,EAFC;AAGXC,MAAAA,UAAU,EAAE,EAHD;AAIXC,MAAAA,SAAS,EAAE,EAJA;AAKXC,MAAAA,MAAM,EAAE,EALG;AAMXC,MAAAA,UAAU,EAAE,EAND;AAOXC,MAAAA,KAAK,EAAE,EAPI;AAQXW,MAAAA,MAAM,EAAE;AACJhB,QAAAA,QAAQ,EAAE,EADN;AAEJK,QAAAA,KAAK,EAAE,EAFH;AAGJJ,QAAAA,UAAU,EAAE,EAHR;AAIJC,QAAAA,SAAS,EAAE;AAJP,OARG;AAcX4B,MAAAA,UAAU,EAAE,CAdD;AAeXG,MAAAA,WAAW,EAAE,CAfF;AAgBXL,MAAAA,OAAO,EAAE,CAhBE;AAiBXc,MAAAA,IAAI,EAAE,IAjBK;AAkBXC,MAAAA,IAAI,EAAE,IAlBK;AAmBTC,MAAAA,QAAQ,EAAC;AAnBA,KAAb;AAqBA,SAAKf,QAAL,GAAgB,KAAKA,QAAL,CAAcgB,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKC,WAAL,GAAmB,KAAKA,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKlB,QAAL,GAAgB,KAAKA,QAAL,CAAckB,IAAd,CAAmB,IAAnB,CAAhB;AACD;;AACDE,EAAAA,yBAAyB,GAAE;AACzB,SAAKC,iBAAL;AACD;;AACDA,EAAAA,iBAAiB,GAAG;AACjB,UAAMC,KAAK,GAAGC,YAAY,CAACC,SAA3B;;AACD,QAAIF,KAAJ,EAAW;AACT,YAAMG,OAAO,GAAGhE,UAAU,CAAC6D,KAAD,CAA1B;AACE,WAAKV,QAAL,CAAc;AAACE,QAAAA,YAAY,EAAEW,OAAO,CAACC,QAAR,CAAiBtD;AAAhC,OAAd;AACH;;AAEGT,IAAAA,KAAK,CAACgE,GAAN,CAAU,iCAAiC,KAAK9B,KAAL,CAAWzB,EAAtD,EAA0DO,IAA1D,CAAgEC,QAAD,IAAc;AACrE,WAAKgC,QAAL,CAAc;AACXvC,QAAAA,QAAQ,EAAEO,QAAQ,CAACC,IAAT,CAAcR,QADb;AAEZC,QAAAA,UAAU,EAAEM,QAAQ,CAACC,IAAT,CAAcP,UAFd;AAGZC,QAAAA,SAAS,EAAEK,QAAQ,CAACC,IAAT,CAAcN,SAHb;AAIZC,QAAAA,MAAM,EAAEI,QAAQ,CAACC,IAAT,CAAcL,MAJV;AAKZC,QAAAA,UAAU,EAAEG,QAAQ,CAACC,IAAT,CAAcJ,UALd;AAMZC,QAAAA,KAAK,EAAEE,QAAQ,CAACC,IAAT,CAAcH;AANT,OAAd;AAQH,KATL,EASOkD,KATP,CASaC,GAAG,IAAI;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,KAXL;AAYL;;AAEDG,EAAAA,YAAY,GAAE;AACZ,SAAKpB,QAAL,CAAc;AACZG,MAAAA,IAAI,EAAE,CAAC,KAAKF,KAAL,CAAWE,IADN;AAEZ1B,MAAAA,MAAM,EAAE;AACJhB,QAAAA,QAAQ,EAAE,EADN;AAEJK,QAAAA,KAAK,EAAE,EAFH;AAGJJ,QAAAA,UAAU,EAAE,EAHR;AAIJC,QAAAA,SAAS,EAAE;AAJP,OAFI;AAQZ4B,MAAAA,UAAU,EAAE,CARA;AASZG,MAAAA,WAAW,EAAE,CATD;AAUZL,MAAAA,OAAO,EAAE,CAVG;AAWZe,MAAAA,IAAI,EAAC;AAXO,KAAd;AAaA,QAAI,CAAC,KAAKH,KAAL,CAAWE,IAAhB,EACE,KAAKM,iBAAL;AACH;;AAQDnB,EAAAA,QAAQ,CAAC+B,CAAD,EAAI;AACR;AACE,QAAI5C,MAAM,GAAG,KAAKwB,KAAL,CAAWxB,MAAxB;AAFM,sBAGkB4C,CAAC,CAACC,MAHpB;AAAA,UAGEC,IAHF,aAGEA,IAHF;AAAA,UAGQlD,KAHR,aAGQA,KAHR;;AAKN,YAAQkD,IAAR;AACI,WAAK,UAAL;AACI,aAAKvB,QAAL,CAAc;AAACT,UAAAA,UAAU,EAAE;AAAb,SAAd;AACAd,QAAAA,MAAM,CAAChB,QAAP,GACEY,KAAK,CAACU,MAAN,GAAe,CAAf,IAAoBV,KAAK,CAACU,MAAN,GAAe,EAAnC,GACI,wBADJ,GAEI,EAHN;AAIA;;AACJ,WAAK,OAAL;AACI,aAAKiB,QAAL,CAAc;AAACN,UAAAA,WAAW,EAAE;AAAd,SAAd;AACAjB,QAAAA,MAAM,CAACX,KAAP,GACEQ,eAAe,CAACkD,IAAhB,CAAqBnD,KAArB,KAAgCA,KAAK,CAACU,MAAN,IAAgB,GAAhD,GACI,EADJ,GAEI,qBAHN;AAIA;;AACA,WAAK,YAAL;AACAN,QAAAA,MAAM,CAACf,UAAP,GACEW,KAAK,CAACU,MAAN,GAAe,EAAf,GACI,wBADJ,GAEI,EAHN;AAIA;;AACA,WAAK,WAAL;AACAN,QAAAA,MAAM,CAACd,SAAP,GACEU,KAAK,CAACU,MAAN,GAAe,EAAf,GACI,uBADJ,GAEI,EAHN;AAIA;;AACF;AACE;AA5BR;;AA8BA,SAAKiB,QAAL,CAAc;AAACvB,MAAAA,MAAD;AAAS,OAAC8C,IAAD,GAAQlD;AAAjB,KAAd;AACL;;AACDkC,EAAAA,WAAW,CAACc,CAAD,EAAI;AACb,SAAKrB,QAAL,CAAc;AAACI,MAAAA,IAAI,EAACiB,CAAC,CAACC,MAAF,CAASG,KAAT,CAAe,CAAf;AAAN,KAAd;AACD;;AACDC,EAAAA,SAAS,GAAE;AACP,QAAIC,GAAG,GAAG,KAAK1B,KAAL,CAAWG,IAArB;AACA,UAAMwB,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBH,GAAxB;AACA5E,IAAAA,KAAK,CAACM,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AACAP,IAAAA,KAAK,CACFQ,GADH,CACO,iCAA+B,KAAK0B,KAAL,CAAWzB,EADjD,EACqDoE,QADrD,EAEG7D,IAFH,CAEQI,GAAG,IACL;AAAC+C,MAAAA,OAAO,CAACC,GAAR,CAAYhD,GAAG,CAACF,IAAJ,CAAS8D,UAArB;AACG,WAAK9C,KAAL,CAAW+C,SAAX,CAAqB;AAACD,QAAAA,UAAU,EAAC5D,GAAG,CAACF,IAAJ,CAAS8D;AAArB,OAArB;AACH,KALP,EAQGf,KARH,CAQSC,GAAG,IAAI;AACVC,MAAAA,OAAO,CAACe,IAAR,CAAahB,GAAb;AACA,WAAKjB,QAAL,CAAc;AAACK,QAAAA,QAAQ,EAAC;AAAV,OAAd;AACH,KAXH;AAaH;;AACDjB,EAAAA,QAAQ,CAACiC,CAAD,EAAI;AACVA,IAAAA,CAAC,CAACa,cAAF;AACA,SAAKlC,QAAL,CAAc;AAACX,MAAAA,OAAO,EAAE;AAAV,KAAd;AACA,SAAKW,QAAL,CAAc;AAACT,MAAAA,UAAU,EAAE;AAAb,KAAd;AACA,SAAKS,QAAL,CAAc;AAACN,MAAAA,WAAW,EAAE;AAAd,KAAd;AAEA,UAAMtC,WAAW,GAAG;AAClBI,MAAAA,EAAE,EAAE,KAAKyB,KAAL,CAAWzB,EADG;AAElBC,MAAAA,QAAQ,EAAE,KAAKwC,KAAL,CAAWxC,QAFH;AAGlBC,MAAAA,UAAU,EAAE,KAAKuC,KAAL,CAAWvC,UAHL;AAIlBC,MAAAA,SAAS,EAAE,KAAKsC,KAAL,CAAWtC,SAJJ;AAKlBC,MAAAA,MAAM,EAAE,KAAKqC,KAAL,CAAWrC,MALD;AAMlBC,MAAAA,UAAU,EAAE,KAAKoC,KAAL,CAAWpC,UANL;AAOlBC,MAAAA,KAAK,EAAE,KAAKmC,KAAL,CAAWnC;AAPA,KAApB;AASE,UAAMqE,IAAI,GAAC;AACTrE,MAAAA,KAAK,EAAE,KAAKmC,KAAL,CAAWnC,KADT;AAEPL,MAAAA,QAAQ,EAAE,KAAKwC,KAAL,CAAWxC;AAFd,KAAX;;AAKD,QAAIe,YAAY,CAAC,KAAKyB,KAAL,CAAWxB,MAAZ,CAAhB,EAAqC;AACjCtB,MAAAA,MAAM,CAACC,WAAD,CAAN,CAAoBW,IAApB,CAAyBI,GAAG,IAAI;AAC5B,YAAIA,GAAG,IAAI,SAAX,EAAsB;AAClB,cAAI,KAAK8B,KAAL,CAAWG,IAAf,EAAoB;AAChB,iBAAKsB,SAAL;AACA,iBAAKzC,KAAL,CAAWmD,UAAX,CAAsBD,IAAtB;AACH,WAHD,MAKI;AAC2BjB,YAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AAEvB,iBAAKlC,KAAL,CAAWmD,UAAX,CAAsBD,IAAtB;AACH;;AACP,eAAKnC,QAAL,CAAc;AAACG,YAAAA,IAAI,EAAE,IAAP;AAAaC,YAAAA,IAAI,EAAC;AAAlB,WAAd;AACD;;AACD,YAAIjC,GAAG,IAAI,gBAAX,EAA4B;AACxB,eAAK6B,QAAL,CAAc;AAACT,YAAAA,UAAU,EAAE;AAAb,WAAd;AACA,eAAKS,QAAL,CAAc;AAACX,YAAAA,OAAO,EAAE;AAAV,WAAd;AACH;;AACD,YAAIlB,GAAG,IAAI,aAAX,EAAyB;AACrB,eAAK6B,QAAL,CAAc;AAACN,YAAAA,WAAW,EAAE;AAAd,WAAd;AACA,eAAKM,QAAL,CAAc;AAACX,YAAAA,OAAO,EAAE;AAAV,WAAd;AACH;AACJ,OAtBD;AAuBH,KAxBD,MAyBI;AACA,WAAKW,QAAL,CAAc;AAACX,QAAAA,OAAO,EAAE;AAAV,OAAd;AACH;AACH;;AAEDgD,EAAAA,MAAM,GAAG;AACP,WACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKpC,KAAL,CAAWE,IAAX,IAAmB,oBAAC,WAAD;AAChB,MAAA,QAAQ,EAAE,KAAKF,KAAL,CAAWxC,QADL;AAEhB,MAAA,UAAU,EAAE,KAAKwC,KAAL,CAAWvC,UAFP;AAGhB,MAAA,SAAS,EAAE,KAAKuC,KAAL,CAAWtC,SAHN;AAIhB,MAAA,MAAM,EAAE,KAAKsC,KAAL,CAAWrC,MAJH;AAKhB,MAAA,UAAU,EAAE,KAAKqC,KAAL,CAAWpC,UALP;AAMhB,MAAA,KAAK,EAAE,KAAKoC,KAAL,CAAWnC,KANF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADtB,EASI;AAAG,MAAA,SAAS,EAAC,QAAb;AAAsB,MAAA,KAAK,EAAC,QAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACD,KAAKmC,KAAL,CAAWE,IAAX,IAAoB,KAAKF,KAAL,CAAWC,YAAX,IAA2B,KAAKjB,KAAL,CAAWzB,EAA1D,IAAiE,oBAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,MAAlB;AAAyB,MAAA,KAAK,EAAC,WAA/B;AAA2C,MAAA,OAAO,EAAE,KAAK4D,YAAL,CAAkBd,IAAlB,CAAuB,IAAvB,CAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADhE,CATJ,EAYM,CAAC,KAAKL,KAAL,CAAWE,IAAZ,IAAoB,oBAAC,WAAD;AACpB,MAAA,QAAQ,EAAE,KAAKF,KAAL,CAAWxC,QADD;AAEpB,MAAA,UAAU,EAAE,KAAKwC,KAAL,CAAWvC,UAFH;AAGpB,MAAA,SAAS,EAAE,KAAKuC,KAAL,CAAWtC,SAHF;AAIpB,MAAA,MAAM,EAAE,KAAKsC,KAAL,CAAWrC,MAJC;AAKpB,MAAA,UAAU,EAAE,KAAKqC,KAAL,CAAWpC,UALH;AAMpB,MAAA,KAAK,EAAE,KAAKoC,KAAL,CAAWnC,KANE;AAOpB,MAAA,MAAM,EAAE,KAAKmC,KAAL,CAAWxB,MAPC;AAQpB,MAAA,QAAQ,EAAE,KAAKa,QARK;AASpB,MAAA,YAAY,EAAE,KAAKQ,YATC;AAUpB,MAAA,QAAQ,EAAE,KAAKV,QAVK;AAWpB,MAAA,OAAO,EAAE,KAAKa,KAAL,CAAWZ,OAXA;AAYpB,MAAA,UAAU,EAAE,KAAKY,KAAL,CAAWV,UAZH;AAapB,MAAA,WAAW,EAAE,KAAKU,KAAL,CAAWP,WAbJ;AAcpB,MAAA,IAAI,EAAE,KAAKO,KAAL,CAAWE,IAdG;AAepB,MAAA,YAAY,EAAE,KAAKiB,YAfC;AAgBpB,MAAA,WAAW,EAAE,KAAKb,WAhBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZ1B,EA8BI;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC,CAAC,KAAKN,KAAL,CAAWE,IAAZ,IAAoB,oBAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,sBAAlB;AAAyC,MAAA,KAAK,EAAC,WAA/C;AAA2D,MAAA,OAAO,EAAE,KAAKiB,YAAL,CAAkBd,IAAlB,CAAuB,IAAvB,CAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADrB,CA9BJ,CADF,CADF;AAsCD;;AAhOkC;AAoOrC,eAAeV,KAAf","sourcesContent":["import React, { Component } from 'react'\nimport jwt_decode from 'jwt-decode'\nimport moment from \"moment\";\nimport axios from \"axios\";\nimport Alert from \"reactstrap/es/Alert\";\nimport DatePicker from \"react-datepicker\";\nimport Button from \"reactstrap/es/Button\";\n\nconst update = updatedUser => {\n    axios.defaults.withCredentials = true;\n  return axios\n    .put('http://127.0.0.1:5000/users/'+updatedUser.id, {\n      username: updatedUser.username,\n      first_name: updatedUser.first_name,\n      last_name: updatedUser.last_name,\n      gender: updatedUser.gender,\n      birth_date: updatedUser.birth_date,\n      email: updatedUser.email,\n    })\n    .then(response => {\n        return response.data\n    })\n}\n\nconst isChecked = gender =>\n{\n  let res=false;\n  switch(gender.field){\n    case 'Male': res= (gender.value=='male' || gender.value=='Male');\n    break;\n    case 'Female': res= (gender.value=='female' || gender.value=='Female');\n    break;\n    case 'Other': res= (gender.value=='other' || gender.value=='Other');\n    break;\n  }\n  return res;\n}\nconst validEmailRegex =\n  RegExp(/^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i);\n\nconst validateForm = (errors) => {\n  let valid = true;\n  Object.values(errors).forEach(\n    (val) => val.length > 0 && (valid = false)\n  );\n  return valid;\n}\n\nfunction ProfileInfo(props){\n  return (\n     <table className=\"table col-md-6 mx-auto\">\n            <tbody>\n              <tr>\n                <td><b>Username</b></td>\n                <td>{props.username}</td>\n              </tr>\n              <tr>\n                  <td><b>First Name</b></td>\n                <td>{props.first_name}</td>\n              </tr>\n              <tr>\n                  <td><b>Last Name</b></td>\n                <td>{props.last_name}</td>\n              </tr>\n              <tr>\n                  <td><b>Gender</b></td>\n                <td>{props.gender}</td>\n              </tr>\n              <tr>\n                  <td><b>Birth Date</b></td>\n                <td>{moment(props.birth_date).format(\"LL\")}</td>\n              </tr>\n              <tr>\n                  <td><b>Email</b></td>\n                <td>{props.email}</td>\n              </tr>\n            </tbody>\n          </table>\n  );\n}\n\nfunction EditProfile(props){\n  return(\n          <div className=\"col-md-6 mt-3 mx-auto\">\n     <form noValidate onSubmit={props.onSubmit}>\n              <h1 className=\"h3 mb-3 font-weight-normal\">Update Profile</h1>\n              <div className=\"form-group\">\n                  {props.invalid >0 &&  <Alert color=\"danger\">\n                  Your update attempt is invalid. Please try again!\n                </Alert> }\n                <label htmlFor=\"name\">Username</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"username\"\n                  placeholder=\"Enter your username\"\n                  value={props.username}\n                  onChange={props.onChange}\n                  noValidate\n                />\n                 {props.errors.username.length > 0 &&\n                <span className='error'>{props.errors.username}</span>}\n                {props.user_taken > 0 &&\n                <span className='error'>This username is taken</span>}\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"name\">First name</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"first_name\"\n                  placeholder=\"Enter your first name\"\n                  value={props.first_name}\n                  onChange={props.onChange}\n                  noValidate\n                />\n                {props.errors.first_name.length > 0 &&\n                <span className='error'>{props.errors.first_name}</span>}\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"name\">Last name</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"last_name\"\n                  placeholder=\"Enter your last name\"\n                  value={props.last_name}\n                  onChange={props.onChange}\n                  noValidate\n                />\n                 {props.errors.last_name.length > 0 &&\n                <span className='error'>{props.last_name}</span>}\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"name\">Gender</label><br></br>\n                <input type=\"radio\" name=\"gender\" value=\"Male\" onChange={props.onChange} checked={isChecked({field:'Male',value:props.gender})}/> Male<br></br>\n                <input type=\"radio\" name=\"gender\" value=\"Female\" onChange={props.onChange} checked={isChecked({field:'Female',value:props.gender})}/> Female<br></br>\n                <input type=\"radio\" name=\"gender\" value=\"other\" onChange={props.onChange} checked={isChecked({field:'Other',value:props.gender})}/> Other\n              </div>\n              <div className=\"form-group\">\n                  <label htmlFor=\"name\">Birth date</label><br></br>\n                <DatePicker\n                 name=\"birth_date\"\n                 selected={new Date(props.birth_date)}\n                 onChange={props.handlechange}\n                 dateFormat=\"dd/MM/yyyy\"\n                 maxDate={new Date()}\n                />\n              </div>\n              <div className=\"form-group\">\n                <label htmlFor=\"email\">Email address</label>\n                <input\n                  type=\"email\"\n                  className=\"form-control\"\n                  name=\"email\"\n                  placeholder=\"Enter email\"\n                  value={props.email}\n                  onChange={props.onChange}\n                  noValidate\n                />\n                  {props.errors.email.length > 0 &&\n                <span className='error'>{props.errors.email}</span>}\n                 {props.email_taken > 0 &&\n                <span className='error'>This email is taken</span>}\n              </div>\n                <div className=\"form-group\">\n                    <label htmlFor=\"image_file\">Profile Picture</label>\n                    <br/>\n                    <input\n                        type=\"file\"\n                        onChange={props.onchangeimg}\n                        placeholder=\"Update your profile picture\"\n                    />\n                </div>\n              <button\n                type=\"submit\"\n                className=\"btn btn-lg btn-primary btn-block\"\n              >\n                Update\n              </button>\n            </form>\n\n          </div>\n  );\n}\n\nexport class About extends Component {\n  constructor() {\n    super()\n    this.state = {\n      current_user: 0,\n      username: '',\n      first_name: '',\n      last_name: '',\n      gender: '',\n      birth_date: '',\n      email: '',\n      errors: {\n          username: '',\n          email: '',\n          first_name: '',\n          last_name: '',\n      },\n      user_taken: 0,\n      email_taken: 0,\n      invalid: 0,\n      flag: true,\n      file: null,\n        path_img:''\n    }\n    this.onChange = this.onChange.bind(this)\n    this.onChangeImg = this.onChangeImg.bind(this)\n    this.onSubmit = this.onSubmit.bind(this)\n  }\n  componentWillReceiveProps(){\n    this.componentDidMount()\n  }\n  componentDidMount() {\n     const token = localStorage.usertoken\n    if (token) {\n      const decoded = jwt_decode(token)\n        this.setState({current_user: decoded.identity.id});\n    }\n\n        axios.get('http://127.0.0.1:5000/users/' + this.props.id).then((response) => {\n                this.setState({\n                   username: response.data.username,\n                  first_name: response.data.first_name,\n                  last_name: response.data.last_name,\n                  gender: response.data.gender,\n                  birth_date: response.data.birth_date,\n                  email: response.data.email\n                })\n            }).catch(err => {\n                console.log(err)\n            });\n  }\n\n  toggleUpdate(){\n    this.setState({\n      flag: !this.state.flag,\n      errors: {\n          username: '',\n          email: '',\n          first_name: '',\n          last_name: '',\n      },\n      user_taken: 0,\n      email_taken: 0,\n      invalid: 0,\n      file:null\n    });\n    if (!this.state.flag)\n      this.componentDidMount();\n  }\n\n  handleChange = date => {\n    this.setState({\n      birth_date: date\n    });\n  };\n\n  onChange(e) {\n      //  e.preventDefault()\n        let errors = this.state.errors;\n        const { name, value } = e.target;\n\n        switch (name) {\n            case 'username':\n                this.setState({user_taken: 0});\n                errors.username =\n                  value.length < 1 || value.length > 20\n                    ? 'Username is not valid!'\n                    : '';\n                break;\n            case 'email':\n                this.setState({email_taken: 0});\n                errors.email =\n                  validEmailRegex.test(value)  && value.length <= 120\n                    ? ''\n                    : 'Email is not valid!';\n                break;\n                case 'first_name':\n                errors.first_name =\n                  value.length > 20\n                    ? 'First name is too long'\n                    : '';\n                break;\n                case 'last_name':\n                errors.last_name =\n                  value.length > 20\n                    ? 'Last name is too long'\n                    : '';\n                break;\n              default:\n                break;\n        }\n        this.setState({errors, [name]: value});\n  }\n  onChangeImg(e) {\n    this.setState({file:e.target.files[0]})\n  }\n  uploadImg(){\n      let img = this.state.file;\n      const formData = new FormData();\n      formData.append(\"file\", img);\n      axios.defaults.withCredentials = true;\n      axios\n        .put(\"http://127.0.0.1:5000/image/\"+this.props.id, formData)\n        .then(res =>\n            {console.log(res.data.image_file)\n                this.props.updatePic({image_file:res.data.image_file});\n            }\n\n        )\n        .catch(err => {\n            console.warn(err)\n            this.setState({path_img:''})\n        });\n\n  }\n  onSubmit(e) {\n    e.preventDefault()\n    this.setState({invalid: 0});\n    this.setState({user_taken: 0});\n    this.setState({email_taken: 0});\n\n    const updatedUser = {\n      id: this.props.id,\n      username: this.state.username,\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      gender: this.state.gender,\n      birth_date: this.state.birth_date,\n      email: this.state.email,\n    }\n      const info={\n        email: this.state.email,\n          username: this.state.username\n    }\n\n     if (validateForm(this.state.errors)) {\n         update(updatedUser).then(res => {\n             if (res == 'Updated') {\n                 if (this.state.file){\n                     this.uploadImg()\n                     this.props.updateInfo(info);\n                 }\n                 else\n                     {\n                                                console.log(\"here5\");\n\n                         this.props.updateInfo(info);\n                     }\n               this.setState({flag: true, file:null});\n             }\n             if (res == 'Username Taken'){\n                 this.setState({user_taken: 1});\n                 this.setState({invalid: 1});\n             }\n             if (res == 'Email Taken'){\n                 this.setState({email_taken: 1});\n                 this.setState({invalid: 1});\n             }\n         })\n     }\n     else{\n         this.setState({invalid: 1});\n     }\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <div className=\"jumbotron mt-1\">\n          {this.state.flag && <ProfileInfo\n              username={this.state.username}\n              first_name={this.state.first_name}\n              last_name={this.state.last_name}\n              gender={this.state.gender}\n              birth_date={this.state.birth_date}\n              email={this.state.email}\n            />}\n            <p className=\"m-md-4\" align=\"center\">\n          {this.state.flag && (this.state.current_user == this.props.id) && <Button className=\"my-3\" color=\"secondary\" onClick={this.toggleUpdate.bind(this)}>Edit Profile</Button>}\n            </p>\n             {!this.state.flag && <EditProfile\n              username={this.state.username}\n              first_name={this.state.first_name}\n              last_name={this.state.last_name}\n              gender={this.state.gender}\n              birth_date={this.state.birth_date}\n              email={this.state.email}\n              errors={this.state.errors}\n              onChange={this.onChange}\n              handlechange={this.handleChange}\n              onSubmit={this.onSubmit}\n              invalid={this.state.invalid}\n              user_taken={this.state.user_taken}\n              email_taken={this.state.email_taken}\n              flag={this.state.flag}\n              toggleUpdate={this.toggleUpdate}\n              onchangeimg={this.onChangeImg}\n            />}\n            <div className=\"col-md-6 mt-1 mx-auto\">\n            {!this.state.flag && <Button className=\"btn btn-lg btn-block\" color=\"secondary\" onClick={this.toggleUpdate.bind(this)}>Cancel</Button>}\n            </div>\n            </div>\n      </div>\n    )\n  }\n}\n\n\nexport default About"]},"metadata":{},"sourceType":"module"}